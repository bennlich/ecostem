<html>
  <head>
    <title>LiveTile Test</title>
    
    <meta http-equiv="content-type" content="text/html; charset=UTF8">

    <link rel="stylesheet" type="text/css" href="lib/leaflet/leaflet.css"/>
    <link rel="stylesheet" type="text/css" href="css/ecostem.css"/>
    <link rel="stylesheet" type="text/css" href="css/svg.css"/>

    <script src="https://cdn.firebase.com/js/client/1.0.2/firebase.js"></script>
    <script src="http://maps.google.com/maps/api/js?v=3&sensor=false"></script>

    <script src="lib/agentscript.js"></script>
    <script src="lib/data.js"></script>
    <script src="lib/underscore.js"></script>
    <script src="lib/jquery-1.10.2.js"></script>
    <script src="lib/jquery.event.drag-2.2/jquery.event.drag-2.2.js"></script>
    <script src="lib/leaflet/leaflet-src.js"></script>
    <script src="lib/angular/angular.js"></script>
    <script src="lib/angular/angular-route.js"></script>
    <script src="lib/d3.js"></script>
    <script src="lib/Smooth-0.1.7.js"></script>
    <script src="lib/curveFit.js"></script>
    <script src="lib/Google.js"></script>

    <script src="js/Util.js"></script>
    <script src="js/livetexture.js"></script>

    <script>

      $(document).ready(function() {
        var map = new L.Map('map',{
          minZoom: 3, 
          maxZoom: 15
        });

        map.setView(new L.LatLng(36.42835637785987, -105.633544921875), 12);
        map.addLayer(new L.Google('TERRAIN'));

        var liveTexture = new LiveTexture(map);

        liveTexture.onLayerAppeared(function(id, name, layer) {
          if (!name)
            return;

          $('#layers').append(
             ('<div id="{0}">'
             +  '<input id="cb{0}" type="checkbox"></input>&nbsp;'
             +  '<label for="cb{0}">{1}</label>'
             +  '<a style="float:right;">pan</a>'
             +'</div>').format(id, name));
        });

        liveTexture.onLayerDisappeared(function(id, name, layer) {
          map.removeLayer(layer);

          $('#' + id).remove();
        });

        $(document).on('click', 'input[type=checkbox]', function() {
          var checked = $(this).prop('checked'),
              id = $(this).parent().attr('id'),
              name = $(this).parent().children('label').text(),
              layer = liveTexture.findLayer(id);

          checked ? map.addLayer(layer) : map.removeLayer(layer);
        });

        $(document).on('click', 'a', function() {
          var id = $(this).parent().attr('id'),
              bbox = liveTexture.findBBox(id);
          map.fitBounds(bbox);
        });
      });
    </script>
  </head>
  <body>
    <div class="container">
      <div id="map"></div>
      <div id="layers" class="layers uibox"></div>
    </div>
  </body>
</html>
